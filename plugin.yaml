##################################################################################
# Cloudify OpenStack built in types and plugins definitions.
##################################################################################

plugins:
  openstack_adds:
    executor: central_deployment_agent
    source: https://github.com/boucherv-orange/cloudify-openstack-adds-plugin/archive/master.zip
    package_name: cloudify-openstack-adds-plugin
    package_version: '1.4'

node_types:
  cloudify.openstack_adds.nodes.DNS_client:
    derived_from: cloudify.nodes.Compute
    properties:
      dns_ips:
        default: []
      domains:
        default: []
    interfaces:
      cloudify.interfaces.lifecycle:
        create:
          implementation: openstack_adds.designate_plugin.zones.add_zones
        delete:
          implementation: openstack_adds.designate_plugin.zones.del_zones

relationships:
  cloudify.openstack_adds.node_connected_to_DNS:
    derived_from: cloudify.relationships.connected_to
    source_interfaces:
      cloudify.interfaces.relationship_lifecycle:
        establish:
          implementation: openstack_adds.designate_plugin.recordsets.add_node
          executor: central_deployment_agent
          inputs:
            domain:
              default: exemple.com
            record_ip:
              default: ""
            other_roles: 
              default: []
            other_records:
              default: []
        unlink:
          implementation: openstack_adds.designate_plugin.recordsets.del_node
          executor: central_deployment_agent
          inputs:
            domain:
              default: exemple.com
            record_ip:
              default: ""
            other_roles: 
              default: []
            other_records:
              default: []
